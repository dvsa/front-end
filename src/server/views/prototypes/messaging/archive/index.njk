{% extends 'layouts/mts.layout.njk' %}

{% set pageTitle = 'Create a notification' %}

{% set pageBreadcrumbItems = [
  { text: 'Home', url: '/prototypes' },
  { text: 'Messages' }
] %}

{% block content %}

  {% call components.gridRow() %}

    {% call components.columnFull() %}

      {{ components.pageHeading(heading='Archived') }}

      {% if flashMessage != '' %}

        <div class="message--success">

          <p> {{ flashMessage }} </p>

        </div>

      {% endif %}
 
        <div class="c-tab-list">
          <ul class="c-tab-list__tabs message-filters__tabs">          
            <li>
              <a href="/prototypes/messaging" class="c-tab-list__tab-link  message-filters__tab">Inbox</a>
            </li>
            <li>
              <span class="c-tab-list__tab-link c-tab-list__tab-link--active message-filters__tab message-filters__tab--active">Archived</span>
            </li>
          </ul>

          <div class="message-filters__tab-panel"> 

            <div class="message-panel"> 

              {% if viewData.archive.length %}
                <h3 class="heading-small message-panel__title">
                Archived</h3> 
                {% else %}
                <p class="message-panel__notice u-margin-bottom-10">No archived messages</p> 
              {% endif %}

               {% if viewData.archive.length %}
              
                <ul class="message-panel__messages">

                {% for message in viewData.archive %}

                  <li data-type="{{ message.type }}" class="message-panel__message">
                    <div class="message-panel__inner">
                      <h4 class="message-panel__message-title">
                      {{message.title}}
                      </h4>
                    
                      <ul class="message-panel__details">
                        <li>Date received: {{message.date.received}} </li>
                        <li>Type: {{message.type}} </li>
                        {% if message.type=='Special notice' and not message.state.acknowledged %}
                          <li>Action: Acknowledgment required</li>
                        {% elseif message.type=='Notification' and not message.state.accepted and not message.state.rejected %}
                          
                        {% endif %}
                      </ul>
                    </div>
                    <div class="message-panel__view">
                      <a href="/prototypes/messaging/{{message.id}}" class="">View message</a>
                    </div> 
                  </li>
                  {% endfor %} 
                </ul>

                {% endif %}
            </div> 

          </div>

        <div class="u-margin-top-30 u-margin-bottom-30">
          {{ components.link(text='Return to home', url='/prototypes/mts-messages', paragraph=true) }}
        </div>

    </div>

    {%- endcall %} 
    {%- endcall %} 
  
{% endblock %}
